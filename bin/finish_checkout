#!/bin/sh
#
# $Id$
#
# Completes the checkout of a Bang! build directory

LOCAL_LIBS=../../../lib
TOOLS_LIBS=/export/tools/lib/java
ROOT=`dirname $0 | sed s:/bin$::`
ANT=ant

make_symlinks() {
    while [ "$1" != "" ]; do
        if [ -f $TOOLS_LIBS/$1 ]; then
            # echo Using $TOOLS_LIBS/$1...
            ln -sf $TOOLS_LIBS/$1 .
        else
            # echo Using $LOCAL_LIBS/$1...
            ln -sf $LOCAL_LIBS/$1 .
        fi
        shift
    done
}

# sanity check
if [ ! -d $ROOT/projects ]; then
    echo "Run this script with a full path (not as ./finish_checkout)."
    exit -1
fi

# set up the necessary library symlinks
cd $ROOT/projects/jme-bui/lib
make_symlinks \
    jme.jar \
    lwjgl.jar

cd $ROOT/projects/samskivert/lib
make_symlinks \
    servlet-2.3.jar \
    mail.jar \
    commons-collections.jar \
    commons-digester.jar \
    commons-logging.jar \
    velocity-1.5-dev.jar

cd $ROOT/projects/narya/lib
make_symlinks `cat LIBS`

cd $ROOT/projects/getdown/lib
make_symlinks `cat LIBS`

# create the necessary symlinks in $ROOT/lib
cd $ROOT/projects
for PROJECT in jme-bui samskivert narya threerings getdown; do
    cd $ROOT/projects/$PROJECT
    $ANT clean dist
    cd $ROOT/lib
    ln -sf ../projects/$PROJECT/dist/*.jar .
done
