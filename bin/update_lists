#!/bin/sh
#
# $Id$
#
# A script run as part of the build process to update our lists of props,
# units, etc.

BANG_HOME=`dirname $0`
BANG_HOME=`cd $BANG_HOME/.. ; pwd`
TOWNS="frontier_town indian_post boom_town ghost_town city_of_gold"

cd $BANG_HOME

# Update our list of props
for TOWN in $TOWNS; do
    mkdir -p dist/rsrc/props/$TOWN
    find rsrc/props/$TOWN -name 'prop.properties' | \
        sed 's:rsrc/props/::g' | sed 's:/prop.properties::' | sort > \
        dist/rsrc/props/$TOWN/props.txt
done

# Update our list of units
for TOWN in $TOWNS; do
    mkdir -p dist/rsrc/units/$TOWN
    find rsrc/units/$TOWN -name 'unit.properties' | \
        sed 's:rsrc/units/::g' | sed 's:/unit.properties::' | sort > \
        dist/rsrc/units/$TOWN/units.txt
done

# Update our list of bonuses
for TOWN in $TOWNS; do
    mkdir -p dist/rsrc/bonuses/$TOWN
    find rsrc/bonuses/$TOWN -name 'bonus.properties' | \
        sed 's:rsrc/bonuses/::g' | sed 's:/bonus.properties::' | sort > \
        dist/rsrc/bonuses/$TOWN/bonuses.txt
done

# Update our lists of particle effects and icons
for TOWN in $TOWNS; do
    mkdir -p dist/rsrc/effects/$TOWN
    find rsrc/effects/$TOWN -name 'particles.properties' | \
        sed 's:rsrc/effects/::g' | sed 's:/particles.properties::' | sort > \
        dist/rsrc/effects/$TOWN/particles.txt
    find rsrc/effects/$TOWN -name 'icon.properties' | \
        sed 's:rsrc/effects/::g' | sed 's:/icon.properties::' | sort > \
        dist/rsrc/effects/$TOWN/icons.txt
done

# Update our list of terrain codes
find rsrc/terrain -name 'terrain.properties' | \
  sed 's:rsrc/terrain/::g' | sed 's:/terrain.properties::' | \
  ./bin/update_terrain_codes

# Update our list of bounties
for TOWN in $TOWNS; do
    mkdir -p dist/rsrc/bounties/$TOWN
    find rsrc/bounties/$TOWN -name 'bounty.properties' | \
        sed 's:rsrc/bounties/::g' | sed 's:/bounty.properties::' | sort > \
        dist/rsrc/bounties/$TOWN/bounties.txt
done
