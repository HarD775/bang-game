#
# $Id$
#
# Proguard configuration file for Bang! production client

-injars ../dist/lib/commons-io.jar(!META-INF/*)
-injars ../dist/lib/commons-collections.jar(!META-INF/*)
-injars ../dist/lib/getdown.jar(!META-INF/*,!**/tools/**)
-injars ../dist/lib/narya-base.jar(!META-INF/*,!**/tools/**)
-injars ../dist/lib/narya-distrib.jar(!META-INF/*,!**/tools/**,!**/persist/**,!**/peer/server/**)
-injars ../dist/lib/nenya-rsrc.jar(!META-INF/*,!**/tools/**)
-injars ../dist/lib/nenya-media.jar(!META-INF/*,!**/tools/**)
-injars ../dist/lib/nenya-cast.jar(!META-INF/*,!**/tools/**)
-injars ../dist/lib/nenya-jme.jar(
  !META-INF/*,!**/jme/tools/*Task.class,**/jme/tools/**,!**/tools/**)
-injars ../dist/lib/nenya-openal.jar(!META-INF/*,!**/tools/**)
-injars ../dist/lib/vilya-parlor.jar(!META-INF/*,!**/tools/**,!**/persist/**,!**/ezgame/**)
-injars ../dist/lib/vilya-stats.jar(!META-INF/*,!**/tools/**,!**/persist/**)
-injars ../dist/lib/samskivert.jar(
  com/samskivert/Log.class,**/io/**,**/net/**,**/swing/**,**/text/**,**/util/**,**/xml/**,
  **/servlet/user/Password.class,**/servlet/user/UserUtil.class)
-injars ../dist/lib/jme.jar(!META-INF/*)
-injars ../dist/lib/jme-effects.jar(!META-INF/*)
-injars ../dist/lib/jme-model.jar(!META-INF/*)
-injars ../dist/lib/jme-terrain.jar(!META-INF/*)
-injars ../dist/lib/jme-awt.jar(!META-INF/*)
-injars ../dist/lib/jme-sound.jar(!META-INF/*,!**/fmod/**)
-injars ../dist/lib/jme-gamestates.jar(!META-INF/*)
-injars ../dist/lib/jme-scene.jar(!META-INF/*)
-injars ../dist/lib/jme-bui.jar(!META-INF/*,!**/tests/**)
-injars ../dist/lib/threerings.jar(**/coin/data/**,**/IdentUtil*.class)
-injars ../dist/lib/hemiptera.jar(!**/web/**,!**/persist/**,!install.properties)
-injars ../dist/lib/jorbis-0.0.12.jar(!META-INF/*)
-injars ../dist/lib/jogg-0.0.5.jar(!META-INF/*)
-injars ../dist/lib/jl1.0.jar(!META-INF/*)
-injars ../dist/bang-code.jar(!META-INF/*,!**/tools/**,!**/tests/**,!**/server/**)

-libraryjars <java.home>/lib/rt.jar
-libraryjars ../dist/lib/lwjgl.jar
-libraryjars ../dist/lib/commons-beanutils.jar
-libraryjars ../dist/lib/commons-digester.jar
-libraryjars ../dist/lib/commons-logging.jar

# -dontoptimize
# -dontobfuscate

-dontskipnonpubliclibraryclasses
-outjars ../dist/bang-pcode.jar
-printseeds ../dist/proguard.seeds
@apply_mapping@ @apply_file@
-printmapping proguard/@version@.map
-renamesourcefileattribute SourceFile
-keepattributes SourceFile,LineNumberTable

-keepnames class * implements java.io.Serializable
-keepclassmembers class * implements java.io.Serializable {
    static final long serialVersionUID;
    !static !transient <fields>;
    private void writeObject (java.io.ObjectOutputStream);
    private void readObject (java.io.ObjectInputStream);
}

-keep class * implements com.jme.util.export.Savable

-keep public class * extends com.threerings.presents.dobj.DObject {
    !static !transient <fields>;
}
-keep public class * implements com.threerings.io.Streamable {
    !static !transient <fields>;
    <init> ();
    public void readObject (com.threerings.io.ObjectInputStream);
    public void writeObject (com.threerings.io.ObjectOutputStream);
}

-keep public class * extends java.lang.Enum {
    *;
}

-keep public class com.threerings.media.tile.SwissArmyTileSet
-keep public class com.threerings.media.tile.TrimmedTileSet

-keep public class * extends com.samskivert.swing.Controller {
    *;
}

-keep public class * extends com.threerings.jme.model.ModelController {
    *;
}

-keep public class com.threerings.bang.client.Config {
    <fields>;
}

# this should be included because it implements Serializable, but somehow is not
-keep public class com.threerings.bang.avatar.util.BucklePartCatalog {
    *;
}

-keep public class com.threerings.bang.client.BangApp {
    public static void main (java.lang.String[]);
}

-keep public class com.threerings.bang.editor.EditorApp {
    public static void main (java.lang.String[]);
}

-keep public class com.threerings.bang.editor.EditorManager {
    *;
}

-keep public class com.threerings.bang.viewer.ViewerApp {
    public static void main (java.lang.String[]);
}

-keep public class com.threerings.jme.tools.ModelViewer {
    public static void main (java.lang.String[]);
}

-keep public class com.threerings.bang.data.Badge {
    static <fields>;
}

-keep public class com.threerings.stats.data.Stat {
    static <fields>;
}

-keep public class com.threerings.jme.tools.*Def** {
    public *;
}

-keep public class com.threerings.bang.game.data.TutorialConfig** {
    public *;
}

-keep public class com.threerings.jme.tools.xml.* {
    public *;
}

# Prevent this interface from being nixed entirely
-keep public interface com.threerings.stats.data.StatSet$Container {
    public <methods>;
}

# Bug worky aroundy; Proguard is erroneously stripping all methods out of this
# interface and -keepclassmembers doesn't seem to fix it only -keep
-keep public interface com.threerings.media.util.AStarPathUtil$ExtendedTraversalPred {
    public <methods>;
}
